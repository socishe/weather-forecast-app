(this["webpackJsonpweather-app"]=this["webpackJsonpweather-app"]||[]).push([[0],{21:function(e,t,a){e.exports=a(49)},26:function(e,t,a){},27:function(e,t,a){},29:function(e,t,a){},30:function(e,t,a){},31:function(e,t,a){},49:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),i=a(19),r=a.n(i),o=(a(26),a(3)),m=a(4),l=a(6),s=a(5),u=(a(27),a(9)),p=a(7),d=a.n(p),h=a(20),f=a(2),v=(a(29),a(30),function(e){var t=e.data,a=e.units;return c.a.createElement("div",{className:"main-display"},c.a.createElement("h1",{className:"date"},t.date),c.a.createElement("div",{className:"weather-image"},void 0!==t.data.low&&void 0===t.data.high?c.a.createElement(c.a.Fragment,null,c.a.createElement("img",{src:"http://openweathermap.org/img/w/".concat(t.data.low.weather.icon,".png"),alt:t.data.low.weather.desciption})):c.a.createElement(c.a.Fragment,null,c.a.createElement("img",{src:"http://openweathermap.org/img/w/".concat(t.data.high.weather.icon,".png"),alt:t.data.high.weather.desciption}))),c.a.createElement("div",{className:"temeratures"},void 0!==t.data.low&&c.a.createElement(c.a.Fragment,null,"Min: ","".concat(t.data.low.temp," ").concat(a))),c.a.createElement("div",{className:"temeratures"},void 0!==t.data.high&&c.a.createElement(c.a.Fragment,null,"Max: ","".concat(t.data.high.temp," ").concat(a))))}),b=function(e){var t=e.weather,a=e.units,n=e.error;return c.a.createElement(c.a.Fragment,null,0===t.length?c.a.createElement("div",null,n?"Failed to load":"Loading!"):c.a.createElement("div",{className:"list-group"},t.map((function(e){return c.a.createElement(v,{data:e,key:e.date,units:a})}))))},E=(a(31),function(e){Object(l.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,c=new Array(n),i=0;i<n;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).state={city:"Cape Town"},e.onFormSubmit=function(t){t.preventDefault(),e.props.onSubmit(e.state.city)},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:"inline-input"},c.a.createElement("form",{onSubmit:this.onFormSubmit},c.a.createElement("input",{type:"text",placeholder:"Search for a place",value:this.state.city,onChange:function(t){return e.setState({city:t.target.value})}})))}}]),a}(n.Component)),g=a(8),w=a.n(g),y="87c4d0766e312391d63eb4c67ad58131",O=function(){var e=Object(n.useState)({city:"Cape Town",tempUnits:"celsius",tempSymbol:"\xb0C"}),t=Object(f.a)(e,2),a=t[0],i=t[1],r=Object(n.useState)({icon:"",main:"",tempUnits:"celsius",mainTemp:0,timezone:"",temp:{min:0,max:0}}),o=Object(f.a)(r,2),m=o[0],l=o[1],s=Object(n.useState)([]),p=Object(f.a)(s,2),v=p[0],g=p[1],O=Object(n.useState)(!1),j=Object(f.a)(O,2),N=j[0],S=j[1],x=Object(n.useState)(!1),C=Object(f.a)(x,2),T=C[0],k=C[1],F=Object(n.useState)(!1),M=Object(f.a)(F,2),z=M[0],U=M[1],W=Object(n.useState)(0),_=Object(f.a)(W,2),D=_[0],J=_[1],q=function(e){var t=new Date,a=t.getTime(),n=6e4*t.getTimezoneOffset(),c=new Date(a+n+1e3*e);return c.toDateString()+", "+c.toTimeString()};Object(n.useEffect)((function(){!function e(){var t="https://api.openweathermap.org/data/2.5/weather?q=".concat(a.city,"&units=metric&appid=").concat(y);w.a.get(t).then((function(t){var a=t.data;l({icon:a.weather[0].icon,main:a.weather[0].main,timezone:q(a.timezone),mainTemp:Math.round(a.main.temp),temp:{min:Math.round(a.main.temp_min),max:Math.round(a.main.temp_max)}}),setTimeout((function(){e()}),12e5)})).catch((function(){}))}()}),[a.city]);var A=Object(n.useCallback)((function(){return new Promise((function(e,t){var n="https://api.openweathermap.org/data/2.5/forecast?q=".concat(a.city,"&units=metric&appid=").concat(y);w.a.get(n).then((function(t){var a=t.data;if("200"===a.cod){e(!1);var n=a.list.filter((function(e){var t=e.dt_txt.split(" ")[1];return"00:00:00"===t||"12:00:00"===t})),c=[];n.forEach((function(e){var t=e.dt_txt.split(" ")[0];c[t]?c[t].push(e):c[t]=[e]}));var i=Object.entries(c);i=i.filter((function(e){return 1!==e[1].length}));var r=[];i.forEach((function(e){var t={};e[1].forEach((function(e){var a=e.dt_txt.split(" ")[1],n=Math.round(e.main.temp),c={temp:n,mainTemp:n,weather:e.weather[0]};"12:00:00"===a?t.high=c:t.low=c})),r.push({date:e[0],data:t})})),g(r)}else e(!0)})).catch((function(t){e(!0)}))}))}),[a.city]),B=Object(n.useCallback)(function(){var e=Object(h.a)(d.a.mark((function e(t,a){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t().then((function(e){return e}));case 2:e.sent?a<=16e3?(console.log("Next delay",a),S(!0),J(a),n=setTimeout((function(){z?(U(!1),clearTimeout(n)):B(t,2*a)}),a)):(console.log("Just stop trying."),k(!0),S(!1),J(0)):(S(!1),J(0));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),[z]);Object(n.useEffect)((function(){B(A,2e3)}),[B,a.city,A]);var R=function(e,t){return"celsius"!==t?(a=e,Math.round(1.8*a+32)):(n=e,Math.round(5/9*(n-32)));var a,n},I=function(e){var t=e.target.value,n="\xb0C";"celsius"!==t&&(n="\xb0F");var c={icon:m.icon,main:m.main,mainTemp:R(m.mainTemp,t),timezone:m.timezone,temp:{min:R(m.temp.min,t),max:R(m.temp.max,t)}};l(c);var r=v.map((function(e){var a=e;return void 0!==a.data.high&&(a.data.high.temp=R(a.data.high.temp,t)),void 0!==a.data.low&&(a.data.low.temp=R(a.data.low.temp,t)),a}));g(r),i(Object(u.a)(Object(u.a)({},a),{},{tempSymbol:n,tempUnits:t}))};return c.a.createElement("div",{className:"card"},c.a.createElement(E,{onSubmit:function(e){i({city:e,tempUnits:"celsius",tempSymbol:"\xb0C"})}}),c.a.createElement("h1",{className:"main-card-header"},"Weekly weather forecast in ",a.city),c.a.createElement("div",{className:"options-container"},c.a.createElement("label",{htmlFor:"celsius"},c.a.createElement("input",{onChange:I,type:"radio",id:"celsius",checked:"celsius"===a.tempUnits,value:"celsius"}),c.a.createElement("div",null,"Celsius")),c.a.createElement("label",{htmlFor:"fahrenheit"},c.a.createElement("input",{onChange:I,type:"radio",id:"fahrenheit",checked:"fahrenheit"===a.tempUnits,value:"fahrenheit"}),c.a.createElement("div",null,"Fahrenheit"))),c.a.createElement("div",{className:"currentWeather"},c.a.createElement("div",{className:"main-info"},c.a.createElement("div",{className:"temp-measurement"},m.mainTemp),c.a.createElement("div",{className:"temp-unit"},"celsius"===a.tempUnits?"\xb0C":"\xb0F")),c.a.createElement("div",{className:"sub-info"},c.a.createElement("div",{className:"sub-info-datatitle"},"Current Weather Today, ",m.timezone),c.a.createElement("div",{className:"sub-info-text"},m.main),c.a.createElement("div",{className:"sub-info-text"},c.a.createElement("span",{className:"max-temp"},c.a.createElement("i",{className:"mdi mdi-arrow-up"}),"".concat(m.temp.min," ").concat(a.tempSymbol)),c.a.createElement("span",{className:"min-temp"},c.a.createElement("i",{className:"mdi mdi-arrow-down"}),"".concat(m.temp.max," ").concat(a.tempSymbol))))),c.a.createElement(b,{error:T&&!N,weather:v,units:a.tempSymbol}),N&&c.a.createElement("div",{className:"retry-container"},c.a.createElement("button",{className:"retry-btn",onClick:function(){U(!0),S(!1),A().then((function(e){return e}))}},"Retry now"),c.a.createElement("div",null,"Retrying in ".concat(D/1e3," sec."))))},j=function(e){Object(l.a)(a,e);var t=Object(s.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return c.a.createElement("div",{className:"App"},c.a.createElement(O,null))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(j,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[21,1,2]]]);
//# sourceMappingURL=main.cfba54ee.chunk.js.map